# A PLUM Job: Peptide modeLs for Understanding and engineering antiMicrobial therapeutics

**PLUM** is a structured, conditional **Variational Autoencoder (VAE)** framework for the generation of both antimicrobial and non-antimicrobial peptides.  
The software is designed to support both *denovo generation* and *prototype-conditioned generation*.

This repository provides code and data necessary to reproduce the experiments described in the paper.

---

## Data Availability

The complete dataset associated with this study is available at the Google Drive link below.

- **Contents**:  
  - `input_dataset/` contains the training and test data used to train the classification and generative models.  
  - `models/` contains the trained classification models (AMP classifier and AMP MIC classifier) as well as the trained PLUM generative model.  
  - `results/` contains peptides generated by PLUM and baseline methods using both *de novo* generation and prototype-conditioned generation.

- **Access**:  
  - The data are available via Google Drive at the following link:  
    **[Google Drive Dataset](https://drive.google.com/drive/folders/1Zl-ky6RelBA7Wy6bqgHh8R9DWmhRczs9?usp=drive_link)**

---

## Dependencies

The codebase requires the following Python version:

- Python >= 3.12

The software was tested on a Linux-based system.

A complete list of required packages and their versions is provided in:

- `requirements.txt`

---

## Installation

Follow the steps below to install and set up PLUM.

### Step 1: Clone the repository
```bash
git clone https://github.com/priyamayur/PLUM.git
```

### Step 2: Navigate to the project directory
```bash
cd PLUM
```
### Step 3: Create a pip environment and activate it
```bash
python3 -m venv <environment_name>
source <environment_name>/bin/activate
```

### Step 4: Create a pip environment and activate it
```bash
pip install -r requirements.txt
```
---

## Usage

### Classify Peptides as AMP / Non-AMP

PLUM includes a classification script to predict whether a peptide is an antimicrobial peptide (AMP) or not.  
For peptides predicted as AMPs, the model also predicts whether they are **Potent** or **Non-Potent**.

#### Command

python classify_AMP.py -i <input_fasta> -o <output_tsv>

- `-i <input_fasta>` : Path to the input FASTA file containing the peptide sequences you want to classify. Each sequence should have a unique identifier. **Required**.
- `-o <output_tsv>` : Path to the output TSV file where the classification results will be saved. **Required**.

#### Example usage

python classify_AMP.py -i data/peptide_test.fasta -o res/classification_out.tsv

#### output file

The output TSV file from `classify_AMP.py` contains the following columns:

| Column Name   | Description |
|---------------|-------------|
| `seq_id`      | Identifier of the peptide sequence |
| `sequence`    | Peptide amino acid sequence |
| `amp_prob`    | Model probability that the peptide is an AMP |
| `amp_class`   | Predicted class: `AMP` or `Non-AMP` |
| `mic_prob`    | Probability that the peptide is MIC-active (only for AMPs) |
| `mic_class`   | Predicted MIC activity: `MIC_active` or `NA` (Non-AMPs) |

### Generate *de novo* Peptides

PLUM allows generating novel peptide sequences (*de novo*) using the trained generative model.

#### Command

python generate_peptides_denovo.py -f <AMP_function> -l <peptide_length> -n <num_peptides> -o <output_dir>

- `-f <AMP_function>` : Desired function of the peptide.  
  - `1` for AMP  
  - `0` for Non-AMP  
  - **Required**

- `-l <peptide_length>` : Maximum length of the peptide.  
  - Generation may stop before this length if the model decides it is optimal.  
  - Optional; if not provided, the model selects a random length between 5 and 35.

- `-n <num_peptides>` : Number of peptides to generate.  
  - Optional; default is determined by the model.

- `-o <output_dir>` : Directory where the generated peptides will be saved.  
  - Optional; default is `generated_peptides/`. 

#### Example usage

python generate_peptides_denovo.py -f 0 -l 12 -n 30 -o outp_denovo

#### output file

The generated peptides CSV file contains the following columns:

| Column Name | Description |
|-------------|-------------|
| `ID`        | Identifier assigned to the generated peptide (e.g., `peptide_1`) |
| `Peptide`   | Generated peptide amino acid sequence |
| `Function`  | Function class: AMP (`1`) or Non-AMP (`0`) |
| `Length`    | Length of the generated peptide sequence |



### Generate Prototype-conditioned Peptides


#### Command

python generate_peptides_prototype_conditioned.py -i <input_fasta> -f <AMP_function> -l <peptide_length> -n <num_peptides> -o <output_dir>

- `-f <AMP_function>` : Desired function of the peptide.  
  - `1` for AMP  
  - `0` for Non-AMP  
  - **Required**

- `-i <input_fasta>` : Path to the input FASTA file containing the protoype peptide sequences you want to base the generation on. **Required**.
- `-l <peptide_length>` : Maximum length of the peptide.  
  - Generation may stop before this length if the model decides it is optimal.  
  - Optional; if not provided, the model selects a random length between 5 and 35.

- `-n <num_peptides>` : Number of peptides to generate.  
  - Optional; default is determined by the model.

- `-o <output_dir>` : Directory where the generated peptides will be saved.  
  - Optional; default is `generated_peptides_prototype/`. generated_peptides

#### Example usage

python generate_peptides_prototype_conditioned.py -i data/peptide_test.fasta -f 1 -l 11 -n 5 -o out_proto

#### output file

The generated peptides are saved in a CSV file in the specified output directory. The output file contains the following columns:

| Column Name          | Description |
|---------------------|-------------|
| `prototype_sequence` | The prototype peptide sequence used for conditioning |
| `generated_sequence` | The peptide sequence generated by the model |
| `target_func`        | Function class of the generated peptide: AMP (`1`) or Non-AMP (`0`) |
| `target_length`      | Target length specified for generation |
| `prototype_length`   | Length of the prototype peptide sequence |
| `generated_length`   | Length of the generated peptide sequence |

---

## Contact

For questions, comments, or issues, feel free to contact:

- **Priyanka Banerjee**  
  - Email: [pb11@iastate.edu](mailto:pb11@iastate.edu)  
  - Alternate Email: [banerjee.p1104@gmail.com](mailto:banerjee.p1104@gmail.com)